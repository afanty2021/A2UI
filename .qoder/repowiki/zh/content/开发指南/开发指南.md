# 开发指南

<cite>
**本文档中引用的文件**  
- [client-setup.md](file://docs/guides/client-setup.md)
- [agent-development.md](file://docs/guides/agent-development.md)
- [custom-components.md](file://docs/guides/custom-components.md)
- [theming.md](file://docs/guides/theming.md)
- [a2ui_extension.py](file://a2a_agents/python/a2ui_extension/src/a2ui/a2ui_extension.py)
- [A2uiExtension.java](file://a2a_agents/java/src/main/java/org/a2ui/A2uiExtension.java)
- [config.ts](file://renderers/angular/src/lib/config.ts)
- [component-registry.ts](file://renderers/lit/src/0.8/ui/component-registry.ts)
- [theme.ts](file://renderers/lit/src/0.8/ui/context/theme.ts)
- [app.config.ts](file://samples/client/angular/projects/restaurant/src/app/app.config.ts)
- [app.ts](file://samples/client/lit/shell/app.ts)
- [register-components.ts](file://samples/client/lit/contact/ui/custom-components/register-components.ts)
</cite>

## 目录
1. [客户端集成](#客户端集成)
2. [Agent开发](#agent开发)
3. [高级功能](#高级功能)
4. [主题化系统](#主题化系统)

## 客户端集成

本节介绍如何将A2UI集成到客户端应用中，重点介绍Angular和Lit框架的集成步骤。

### Angular集成

在Angular应用中集成A2UI需要执行以下步骤：

1. **安装依赖**：使用npm安装A2UI Angular库和核心Web库。
2. **导入模块**：在应用配置中导入A2UI模块。
3. **提供服务**：使用`provideA2UI`函数配置A2UI，传入组件目录和主题。
4. **注册组件**：确保A2UI组件在应用中可用。

在Angular应用中，`provideA2UI`函数用于配置A2UI，它接受一个包含`catalog`和`theme`的对象作为参数。这在应用的配置文件中完成，确保A2UI在应用启动时正确初始化。

**客户端集成来源**
- [client-setup.md](file://docs/guides/client-setup.md#angular)
- [config.ts](file://renderers/angular/src/lib/config.ts)
- [app.config.ts](file://samples/client/angular/projects/restaurant/src/app/app.config.ts)

### Lit集成

在Lit应用中集成A2UI需要执行以下步骤：

1. **安装依赖**：使用npm安装A2UI Web库和Lit相关库。
2. **导入库**：在应用入口文件中导入A2UI库。
3. **配置主题**：通过Lit的上下文系统提供主题配置。
4. **注册组件**：确保A2UI组件在应用中可用。

在Lit应用中，主题通过`@lit/context`提供的上下文系统进行配置。`themeContext`用于在组件树中传递主题信息，确保所有A2UI组件都能访问到主题配置。

**客户端集成来源**
- [client-setup.md](file://docs/guides/client-setup.md#web-components-lit)
- [app.ts](file://samples/client/lit/shell/app.ts)
- [theme.ts](file://renderers/lit/src/0.8/ui/context/theme.ts)

## Agent开发

本节介绍如何使用Python和Java开发Agent，生成符合规范的A2UI JSON消息。

### Python Agent开发

在Python中开发Agent需要使用`a2ui_extension`库来生成A2UI消息。主要步骤包括：

1. **创建A2UI数据部分**：使用`create_a2ui_part`函数创建包含A2UI数据的A2A部分。
2. **检查A2UI部分**：使用`is_a2ui_part`函数检查A2A部分是否包含A2UI数据。
3. **提取A2UI数据**：使用`get_a2ui_datapart`函数从A2A部分中提取A2UI数据。
4. **配置Agent扩展**：使用`get_a2ui_agent_extension`函数创建A2UI Agent扩展配置。

这些函数帮助开发者在Python Agent中生成和处理A2UI消息，确保消息格式正确并能被客户端正确解析。

**Agent开发来源**
- [agent-development.md](file://docs/guides/agent-development.md)
- [a2ui_extension.py](file://a2a_agents/python/a2ui_extension/src/a2ui/a2ui_extension.py)

### Java Agent开发

在Java中开发Agent同样需要使用`a2ui_extension`库来生成A2UI消息。主要步骤包括：

1. **创建A2UI数据部分**：使用`createA2uiDataPart`方法创建包含A2UI数据的A2A部分。
2. **检查A2UI部分**：使用`isA2uiPart`方法检查A2A部分是否包含A2UI数据。
3. **提取A2UI数据**：使用`getA2uiDataPart`方法从A2A部分中提取A2UI数据。

这些方法帮助开发者在Java Agent中生成和处理A2UI消息，确保消息格式正确并能被客户端正确解析。

**Agent开发来源**
- [agent-development.md](file://docs/guides/agent-development.md)
- [A2uiExtension.java](file://a2a_agents/java/src/main/java/org/a2ui/A2uiExtension.java)

## 高级功能

本节介绍如何通过`componentRegistry.register()`创建自定义组件，以及如何定义和协商自定义组件目录。

### 创建自定义组件

在Lit框架中，可以通过`componentRegistry.register()`方法注册自定义组件。该方法接受组件类型名称、构造函数和可选的标签名作为参数。注册后，该组件可以在A2UI消息中使用。

例如，在联系人应用中，`OrgChart`和`PremiumTextField`组件通过`registerContactComponents`函数注册。`PremiumTextField`组件被注册为`TextField`的替代，允许在不修改Agent代码的情况下自定义组件行为。

**高级功能来源**
- [custom-components.md](file://docs/guides/custom-components.md)
- [register-components.ts](file://samples/client/lit/contact/ui/custom-components/register-components.ts)
- [component-registry.ts](file://renderers/lit/src/0.8/ui/component-registry.ts)

### 定义和协商自定义组件目录

自定义组件目录允许开发者定义一组自定义组件，并与Agent协商使用。客户端定义目录，注册组件，并告知Agent支持的目录。Agent选择目录后，可以使用目录中的组件生成UI。

**高级功能来源**
- [custom-components.md](file://docs/guides/custom-components.md)

## 主题化系统

本节介绍如何通过覆盖`Theme`对象来定制UI样式。

### 覆盖Theme对象

A2UI的主题化系统允许开发者通过覆盖`Theme`对象来定制UI样式。主题对象包含组件、元素和Markdown的样式配置。开发者可以修改这些配置来匹配应用的品牌风格。

在Lit应用中，主题通过`themeContext`提供，确保所有组件都能访问到主题配置。在Angular应用中，主题通过`provideA2UI`函数提供。

**主题化系统来源**
- [theming.md](file://docs/guides/theming.md)
- [theme.ts](file://renderers/lit/src/0.8/ui/context/theme.ts)
- [app.ts](file://samples/client/lit/shell/app.ts)
- [app.config.ts](file://samples/client/angular/projects/restaurant/src/app/app.config.ts)